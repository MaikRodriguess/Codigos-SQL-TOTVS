select * from shorarioturma

where IDHORARIOTURMA = 318781




SELECT 
SPLETIVO.CODPERLET,
SPLETIVO.CODFILIAL,
STURMADISC.IDTURMADISC, 
--Noturno

[07:30-08:15]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030001  THEN 1 END),
[08:15-09:00]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030002  THEN 1 END),
[09:00-09:45]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030003  THEN 1 END),
[10:00-10:45]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030004  THEN 1 END),
[10:45-11:30]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030005  THEN 1 END),
[11:30-12:15]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030006  THEN 1 END),
[11_09]=
COUNT(CASE WHEN SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END),
[06_11]=
COUNT(CASE WHEN SHORARIOTURMA.DATAINICIAL = '2022-11-06' THEN 1 END),
[09_11]=
COUNT(CASE WHEN SHORARIOTURMA.DATAINICIAL = '2022-10-09' THEN 1 END)


FROM STURMADISC (NOLOCK)
INNER JOIN SPLETIVO  (NOLOCK) ON STURMADISC.IDPERLET = SPLETIVO.IDPERLET
LEFT JOIN SHORARIOTURMA (NOLOCK)  ON STURMADISC.IDTURMADISC=  SHORARIOTURMA.IDTURMADISC
LEFT JOIN SHORARIOPROFESSOR (NOLOCK) ON SHORARIOPROFESSOR.IDHORARIOTURMA = SHORARIOTURMA.IDHORARIOTURMA
WHERE 
	SPLETIVO.CODPERLET = '2022/2'
AND .SPLETIVO.CODFILIAL = 2

GROUP BY 
	STURMADISC.IDTURMADISC,
	SPLETIVO.CODPERLET,
	SPLETIVO.CODFILIAL


ORDER BY CODFILIAL
