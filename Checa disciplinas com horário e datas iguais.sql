select * from shorarioturma

where IDHORARIOTURMA = 318781


SELECT 
SPLETIVO.CODPERLET,
SPLETIVO.CODFILIAL,
STURMADISC.IDTURMADISC, 
--Noturno

-- Verifica um c칩digo de hor치rio e uma data especifica e soma 1
[07:30-08:15]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030001 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END),
[08:15-09:00]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030002 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END),
[09:00-09:45]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030003 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END),
[10:00-10:45]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030004 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END),
[10:45-11:30]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030005 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END),
[11:30-12:15]=
COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030006 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END)


FROM STURMADISC (NOLOCK)
INNER JOIN SPLETIVO  (NOLOCK) ON STURMADISC.IDPERLET = SPLETIVO.IDPERLET
LEFT JOIN SHORARIOTURMA (NOLOCK)  ON STURMADISC.IDTURMADISC=  SHORARIOTURMA.IDTURMADISC
LEFT JOIN SHORARIOPROFESSOR (NOLOCK) ON SHORARIOPROFESSOR.IDHORARIOTURMA = SHORARIOTURMA.IDHORARIOTURMA
WHERE 
	SPLETIVO.CODPERLET = '2022/2'
AND SPLETIVO.CODFILIAL = 2
AND STURMADISC.IDTURMADISC = 314910
GROUP BY 
	STURMADISC.IDTURMADISC,
	SPLETIVO.CODPERLET,
	SPLETIVO.CODFILIAL

	-- Lista somente se o c칩digo do hor치rio e a data se repetir na disciplina 
/*HAVING COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030001 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END) > 1
	AND COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030002 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END) > 1
	AND COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030003 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END) > 1
	AND COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030004 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END) > 1
	AND COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030005 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END) > 1
	AND COUNT(CASE
		WHEN SHORARIOTURMA.CODHOR = 1030006 AND SHORARIOTURMA.DATAINICIAL = '2022-09-11' THEN 1 END) > 1*/
ORDER BY CODFILIAL